(window.webpackJsonp=window.webpackJsonp||[]).push([["VS2p"],{VS2p:function(e,t,i){"use strict";i.r(t);var r=i("+Lc1"),l=i("Mz3J"),a=i("Q2AE");var o={101:"未付款",102:"用户取消",103:"系统取消",201:"已付款",202:"申请退款",203:"已退款",301:"已发货",401:"用户收货",402:"系统收货"},n={name:"Order",components:{Pagination:l.a},filters:{orderStatusFilter:function(e){return o[e]}},data:function(){return{list:[],total:0,listLoading:!0,listQuery:{page:1,limit:20,id:void 0,name:void 0,orderStatusArray:[],sort:"add_time",order:"desc"},statusMap:o,orderDialogVisible:!1,orderDetail:{order:{},user:{},orderGoods:[]},shipForm:{orderId:void 0,shipChannel:void 0,shipSn:void 0},shipDialogVisible:!1,refundForm:{orderId:void 0,refundMoney:void 0},refundDialogVisible:!1,downloadLoading:!1}},created:function(){this.getList()},methods:{checkPermission:function(e){if(e&&e instanceof Array&&e.length>0){var t=a.a.getters&&a.a.getters.perms,i=e;return!!(t.indexOf("*")>=0||t.some(function(e){return i.includes(e)}))}return console.error("need perms! Like v-permission=\"['GET /aaa','POST /bbb']\""),!1},getList:function(){var e=this;this.listLoading=!0,Object(r.b)(this.listQuery).then(function(t){e.list=t.data.data.list,e.total=t.data.data.total,e.listLoading=!1}).catch(function(){e.list=[],e.total=0,e.listLoading=!1})},handleFilter:function(){this.listQuery.page=1,this.getList()},handleDetail:function(e){var t=this;Object(r.a)(e.id).then(function(e){t.orderDetail=e.data.data}),this.orderDialogVisible=!0},handleShip:function(e){var t=this;this.shipForm.orderId=e.id,this.shipForm.shipChannel=e.shipChannel,this.shipForm.shipSn=e.shipSn,this.shipDialogVisible=!0,this.$nextTick(function(){t.$refs.shipForm.clearValidate()})},confirmShip:function(){var e=this;this.$refs.shipForm.validate(function(t){t&&Object(r.e)(e.shipForm).then(function(t){e.shipDialogVisible=!1,e.$notify.success({title:"成功",message:"确认发货成功"}),e.getList()}).catch(function(t){e.$notify.error({title:"失败",message:t.data.errmsg})})})},handleRefund:function(e){var t=this;this.refundForm.orderId=e.id,this.refundForm.refundMoney=e.actualPrice,this.refundDialogVisible=!0,this.$nextTick(function(){t.$refs.refundForm.clearValidate()})},confirmRefund:function(){var e=this;this.$refs.refundForm.validate(function(t){t&&Object(r.c)(e.refundForm).then(function(t){e.refundDialogVisible=!1,e.$notify.success({title:"成功",message:"确认退款成功"}),e.getList()}).catch(function(t){e.$notify.error({title:"失败",message:t.data.errmsg})})})},handleDownload:function(){var e=this;this.downloadLoading=!0,Promise.all([i.e("chunk-0d49"),i.e("chunk-eb6b")]).then(i.bind(null,"S/jZ")).then(function(t){t.export_json_to_excel2(["订单ID","订单编号","用户ID","订单状态","是否删除","收货人","收货联系电话","收货地址"],e.list,["id","orderSn","userId","orderStatus","isDelete","consignee","mobile","address"],"订单信息"),e.downloadLoading=!1})}}},s=i("KHd+"),d=Object(s.a)(n,function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入用户ID"},model:{value:e.listQuery.userId,callback:function(t){e.$set(e.listQuery,"userId",t)},expression:"listQuery.userId"}}),e._v(" "),i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{clearable:"",placeholder:"请输入订单编号"},model:{value:e.listQuery.orderSn,callback:function(t){e.$set(e.listQuery,"orderSn",t)},expression:"listQuery.orderSn"}}),e._v(" "),i("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{multiple:"",placeholder:"请选择订单状态"},model:{value:e.listQuery.orderStatusArray,callback:function(t){e.$set(e.listQuery,"orderStatusArray",t)},expression:"listQuery.orderStatusArray"}},e._l(e.statusMap,function(e,t){return i("el-option",{key:e,attrs:{label:e,value:t}})})),e._v(" "),i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["GET /admin/order/list"],expression:"['GET /admin/order/list']"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("查找")]),e._v(" "),i("el-button",{staticClass:"filter-item",attrs:{loading:e.downloadLoading,type:"primary",icon:"el-icon-download"},on:{click:e.handleDownload}},[e._v("导出")])],1),e._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],attrs:{data:e.list,"element-loading-text":"正在查询中。。。",border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center","min-width":"100",label:"订单编号",prop:"orderSn"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"用户ID",prop:"userId"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"订单状态",prop:"orderStatus"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-tag",[e._v(e._s(e._f("orderStatusFilter")(t.row.orderStatus)))])]}}])}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"订单金额",prop:"orderPrice"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"支付金额",prop:"actualPrice"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"支付时间",prop:"payTime"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"物流单号",prop:"shipSn"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"物流渠道",prop:"shipChannel"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"操作",width:"200","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["GET /admin/order/detail"],expression:"['GET /admin/order/detail']"}],attrs:{type:"primary",size:"mini"},on:{click:function(i){e.handleDetail(t.row)}}},[e._v("详情")]),e._v(" "),201==t.row.orderStatus?i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["POST /admin/order/ship"],expression:"['POST /admin/order/ship']"}],attrs:{type:"primary",size:"mini"},on:{click:function(i){e.handleShip(t.row)}}},[e._v("发货")]):e._e(),e._v(" "),202==t.row.orderStatus?i("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["POST /admin/order/refund"],expression:"['POST /admin/order/refund']"}],attrs:{type:"primary",size:"mini"},on:{click:function(i){e.handleRefund(t.row)}}},[e._v("退款")]):e._e()]}}])})],1),e._v(" "),i("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.listQuery.page,limit:e.listQuery.limit},on:{"update:page":function(t){e.$set(e.listQuery,"page",t)},"update:limit":function(t){e.$set(e.listQuery,"limit",t)},pagination:e.getList}}),e._v(" "),i("el-dialog",{attrs:{visible:e.orderDialogVisible,title:"订单详情",width:"800"},on:{"update:visible":function(t){e.orderDialogVisible=t}}},[i("el-form",{attrs:{data:e.orderDetail,"label-position":"left"}},[i("el-form-item",{attrs:{label:"订单编号"}},[i("span",[e._v(e._s(e.orderDetail.order.orderSn))])]),e._v(" "),i("el-form-item",{attrs:{label:"订单状态"}},[i("el-tag",[e._v(e._s(e._f("orderStatusFilter")(e.orderDetail.order.orderStatus)))])],1),e._v(" "),i("el-form-item",{attrs:{label:"订单用户"}},[i("span",[e._v(e._s(e.orderDetail.user.nickname))])]),e._v(" "),i("el-form-item",{attrs:{label:"用户留言"}},[i("span",[e._v(e._s(e.orderDetail.order.message))])]),e._v(" "),i("el-form-item",{attrs:{label:"收货信息"}},[i("span",[e._v("（收货人）"+e._s(e.orderDetail.order.consignee))]),e._v(" "),i("span",[e._v("（手机号）"+e._s(e.orderDetail.order.mobile))]),e._v(" "),i("span",[e._v("（地址）"+e._s(e.orderDetail.order.address))])]),e._v(" "),i("el-form-item",{attrs:{label:"商品信息"}},[i("el-table",{attrs:{data:e.orderDetail.orderGoods,border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{align:"center",label:"商品名称",prop:"goodsName"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"商品编号",prop:"goodsSn"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"货品规格",prop:"specifications"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"货品价格",prop:"price"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"货品数量",prop:"number"}}),e._v(" "),i("el-table-column",{attrs:{align:"center",label:"货品图片",prop:"picUrl"},scopedSlots:e._u([{key:"default",fn:function(e){return[i("img",{attrs:{src:e.row.picUrl,width:"40"}})]}}])})],1)],1),e._v(" "),i("el-form-item",{attrs:{label:"费用信息"}},[i("span",[e._v("\n          (实际费用)"+e._s(e.orderDetail.order.actualPrice)+"元 =\n          (商品总价)"+e._s(e.orderDetail.order.goodsPrice)+"元 +\n          (快递费用)"+e._s(e.orderDetail.order.freightPrice)+"元 -\n          (优惠减免)"+e._s(e.orderDetail.order.couponPrice)+"元 -\n          (积分减免)"+e._s(e.orderDetail.order.integralPrice)+"元\n        ")])]),e._v(" "),i("el-form-item",{attrs:{label:"支付信息"}},[i("span",[e._v("（支付渠道）微信支付")]),e._v(" "),i("span",[e._v("（支付时间）"+e._s(e.orderDetail.order.payTime))])]),e._v(" "),i("el-form-item",{attrs:{label:"快递信息"}},[i("span",[e._v("（快递公司）"+e._s(e.orderDetail.order.shipChannel))]),e._v(" "),i("span",[e._v("（快递单号）"+e._s(e.orderDetail.order.shipSn))]),e._v(" "),i("span",[e._v("（发货时间）"+e._s(e.orderDetail.order.shipTime))])]),e._v(" "),i("el-form-item",{attrs:{label:"收货信息"}},[i("span",[e._v("（确认收货时间）"+e._s(e.orderDetail.order.confirmTime))])])],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.shipDialogVisible,title:"发货"},on:{"update:visible":function(t){e.shipDialogVisible=t}}},[i("el-form",{ref:"shipForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:e.shipForm,"status-icon":"","label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"快递公司",prop:"shipChannel"}},[i("el-input",{model:{value:e.shipForm.shipChannel,callback:function(t){e.$set(e.shipForm,"shipChannel",t)},expression:"shipForm.shipChannel"}})],1),e._v(" "),i("el-form-item",{attrs:{label:"快递编号",prop:"shipSn"}},[i("el-input",{model:{value:e.shipForm.shipSn,callback:function(t){e.$set(e.shipForm,"shipSn",t)},expression:"shipForm.shipSn"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.shipDialogVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.confirmShip}},[e._v("确定")])],1)],1),e._v(" "),i("el-dialog",{attrs:{visible:e.refundDialogVisible,title:"退款"},on:{"update:visible":function(t){e.refundDialogVisible=t}}},[i("el-form",{ref:"refundForm",staticStyle:{width:"400px","margin-left":"50px"},attrs:{model:e.refundForm,"status-icon":"","label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"退款金额",prop:"refundMoney"}},[i("el-input",{attrs:{disabled:!0},model:{value:e.refundForm.refundMoney,callback:function(t){e.$set(e.refundForm,"refundMoney",t)},expression:"refundForm.refundMoney"}})],1)],1),e._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.refundDialogVisible=!1}}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:e.confirmRefund}},[e._v("确定")])],1)],1)],1)},[],!1,null,null,null);d.options.__file="order.vue";t.default=d.exports}}]);